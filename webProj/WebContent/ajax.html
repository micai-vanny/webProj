<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ajax.html</title>
</head>

<body>          
    <form action="empList.do" method = "POST">
        LastName : <input type = "text" name = "last_name" id = ""><br>
        Email : <input type = "text" name = "email" id = ""><br>
        HireDate : <input type = "text" name = "hire_date" id = ""><br>
        JobId: <input type = "text" name = "job_id" id = ""><br>
        <input type = "submit" value = "저장">
        <input type = "reset" value = "취소">
    </form>
	<div id="show"></div>
	<script>
		var xhtp = new XMLHttpRequest();
		// readyState : 1 => connection. 2 => request received.
		// 3 => processing request. 4 => request finished response ready.
		xhtp.onreadystatechange = function() {
			//console.log(xhtp.readyState, xhtp.status, xhtp.responseText);
			if (xhtp.readyState == 4 && xhtp.status == 200) {
				var show = document.getElementById('show');
				var obj = JSON.parse(xhtp.responseText);
				console.log(obj);
				//show.innerHTML = obj.name;
				// console.log(xhtp.responseText);

				// table tr td => div.appendChild();
				var table = document.createElement('table');
				table.setAttribute('border', '1');
				
				// 배열의 개수만큼 tr을 생성.
				for(var data of obj) {
					var tr = document.createElement('tr');
					// field 수만큼 반복해서 td를 생성.
					for ( var field in data) {
						var td = document.createElement('td');
						var text = document.createTextNode(data[field]);

						td.appendChild(text);
						tr.appendChild(td);

					}
					table.appendChild(tr);
				}
				// div#show의 자식으로 table을 달아줌.
				document.getElementById('show').appendChild(table);
			}
		}
		xhtp.open('get', 'http://localhost/webProj/empList.do?dept=50');
		xhtp.send();
	</script>
</body>

</html>